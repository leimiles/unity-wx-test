# ğŸ” ä»£ç å®¡æŸ¥æŠ¥å‘Š - Assets/Runtime

**å®¡æŸ¥æ—¥æœŸ**: 2025-12-24  
**åˆ†æ”¯**: develop  
**å®¡æŸ¥èŒƒå›´**: Assets/Runtime/  
**å®¡æŸ¥äºº**: GitHub Copilot

---

## ğŸ“Š æ€»ä½“æ¦‚è§ˆ

### ç»Ÿè®¡ä¿¡æ¯
- **æ€»æ–‡ä»¶æ•°**: 70 ä¸ª C# æ–‡ä»¶
- **ä¸»è¦æ¨¡å—**: 
  - Agent, Boot, Config, DataUnits, EventBus, Flow, GameManager
  - GameScene, GameWorld, Input, ModularsCharacter, ParticleBudget
  - Perf, Player3C, Players, Singleton, Spawner, SubSystem
  - Turntable, UI, UnitTest, YooUtils

---

## ğŸ“ æ ¸å¿ƒæ¨¡å—å®¡æŸ¥

### 1. GameManager.cs â­â­â­â­â­

**âœ… åšå¾—å¥½çš„åœ°æ–¹**:
- ä½¿ç”¨äº†æŒä¹…åŒ–å•ä¾‹æ¨¡å¼ï¼Œä¿è¯æ¸¸æˆç®¡ç†å™¨çš„å”¯ä¸€æ€§
- è‰¯å¥½çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒOnDestroy ä¸­æ­£ç¡®æ¸…ç†èµ„æº
- ä½¿ç”¨ UniTask è¿›è¡Œå¼‚æ­¥æ“ä½œï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹
- å¼‚å¸¸å¤„ç†å®Œå–„ï¼ŒOperationCanceledException è¢«æ­£ç¡®æ•è·
- ä½¿ç”¨ä¾èµ–æ³¨å…¥æ¨¡å¼ï¼ˆAttachContextï¼‰ï¼Œæé«˜å¯æµ‹è¯•æ€§

**âš ï¸ éœ€è¦æ³¨æ„çš„é—®é¢˜**:

1. **å†…å­˜æ³„æ¼é£é™©** (ğŸ¯ é«˜ä¼˜å…ˆçº§)
   ```csharp
   // ç¬¬31è¡Œï¼šåˆ›å»ºäº†æ–°çš„ Listï¼Œä½†åŸæœ‰çš„ subSystems å¼•ç”¨ä»ç„¶è¢«ä¿ç•™
   _subSystems = new List<ISubSystem>(subSystems);
   ```
   **é—®é¢˜**: å¦‚æœ `AttachContext` è¢«æ„å¤–è°ƒç”¨å¤šæ¬¡ï¼ˆå°½ç®¡æœ‰æ£€æŸ¥ï¼‰ï¼Œå¯èƒ½å¯¼è‡´æ—§çš„ List æ— æ³•è¢« GC å›æ”¶ã€‚
   
   **å»ºè®®**: 
   ```csharp
   _subSystems = subSystems as List<ISubSystem> ?? new List<ISubSystem>(subSystems);
   ```

2. **ç©ºå¼•ç”¨é£é™©** (ğŸ¯ ä¸­ä¼˜å…ˆçº§)
   ```csharp
   // ç¬¬46è¡Œï¼š_flowSwitchBinding å¯èƒ½ä¸º null
   EventBus<RequestFlowSwitchEvent>.Register(_flowSwitchBinding);
   ```
   **é—®é¢˜**: è™½ç„¶ç¬¬ 45 è¡Œåˆ›å»ºäº† bindingï¼Œä½†åœ¨å¹¶å‘åœºæ™¯ä¸‹å¯èƒ½å‡ºç°é—®é¢˜ã€‚
   
   **å»ºè®®**:
   ```csharp
   if (_flowSwitchBinding == null)
   {
       _flowSwitchBinding = new EventBinding<RequestFlowSwitchEvent>(OnRequestFlowSwitch);
   }
   EventBus<RequestFlowSwitchEvent>.Register(_flowSwitchBinding);
   ```

3. **é”™è¯¯å¤„ç†ä¸å®Œæ•´** (ğŸ¯ ä¸­ä¼˜å…ˆçº§)
   ```csharp
   // ç¬¬92-94è¡Œï¼šå¼‚å¸¸è¢«æ•è·ä½†æœªå¤„ç†
   catch (Exception e)
   {
       Debug.LogError($"Failed to run flow {flow.GetType().Name}: {e.Message}");
       // åˆ‡ FlowID.Error
   }
   ```
   **é—®é¢˜**: æ³¨é‡Šè¡¨æ˜åº”è¯¥åˆ‡æ¢åˆ°é”™è¯¯æµç¨‹ï¼Œä½†ä»£ç æœªå®ç°ã€‚
   
   **å»ºè®®**:
   ```csharp
   catch (Exception e)
   {
       Debug.LogError($"Failed to run flow {flow.GetType().Name}: {e.Message}");
       // åˆ‡æ¢åˆ°é”™è¯¯å¤„ç†æµç¨‹
       if (flow.GetType() != typeof(ErrorFlow)) // é¿å…é€’å½’
       {
           RunFlow(FlowID.Error);
       }
   }
   ```

---

### 2. Bootstrap.cs â­â­â­â­

**âœ… åšå¾—å¥½çš„åœ°æ–¹**:
- å®Œå–„çš„å¯åŠ¨æµç¨‹è®¾è®¡ï¼ŒåŒ…å«è¿›åº¦æŠ¥å‘Š
- å¼‚å¸¸å¤„ç†æœºåˆ¶å®Œå–„ï¼Œå¤±è´¥æ—¶æ­£ç¡®æ¸…ç†èµ„æº
- SubSystem ä¼˜å…ˆçº§æ’åºæœºåˆ¶åˆç†
- æ”¯æŒ Required/Optional SubSystemï¼Œçµæ´»æ€§å¥½
- è¿›åº¦æ˜ å°„å™¨è®¾è®¡ä¼˜é›…ï¼ˆBootProgressMapperï¼‰

**âš ï¸ éœ€è¦æ³¨æ„çš„é—®é¢˜**:

1. **èµ„æºæœªé‡Šæ”¾** (ğŸ¯ é«˜ä¼˜å…ˆçº§)
   ```csharp
   // ç¬¬324è¡Œï¼š_bootUI åˆ›å»ºåæœªåœ¨ä»»ä½•åœ°æ–¹é”€æ¯
   _bootUI = Instantiate(bootUI);
   ```
   **é—®é¢˜**: BootUI åœ¨å¯åŠ¨å®Œæˆååº”è¯¥è¢«é”€æ¯ï¼Œä½†ä»£ç ä¸­æ²¡æœ‰æ¸…ç†é€»è¾‘ã€‚
   
   **å»ºè®®**: åœ¨ `OnBootComplete` æˆåŠŸåˆ†æ”¯ä¸­æ·»åŠ ï¼š
   ```csharp
   if (_bootUI != null)
   {
       Destroy(_bootUI);
       _bootUI = null;
   }
   ```

2. **ç©ºå¼•ç”¨æ£€æŸ¥ç¼ºå¤±** (ğŸ¯ ä¸­ä¼˜å…ˆçº§)
   ```csharp
   // ç¬¬49è¡Œï¼šGameManager.Instance å¯èƒ½è§¦å‘è‡ªåŠ¨åˆ›å»º
   var gameManager = GameManager.Instance;
   ```
   **é—®é¢˜**: å¦‚æœ GameManager ä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºï¼Œä½†è¿™å¯èƒ½ä¸æ˜¯é¢„æœŸè¡Œä¸ºã€‚
   
   **å»ºè®®**:
   ```csharp
   if (GameManager.HasInstance)
   {
       var gameManager = GameManager.Instance;
   }
   else
   {
       Debug.LogError("GameManager not found in scene!");
       // å¤„ç†é”™è¯¯
   }
   ```

3. **é­”æ³•å­—ç¬¦ä¸²** (ğŸ¯ ä½ä¼˜å…ˆçº§)
   ```csharp
   // ç¬¬17è¡Œï¼šç¡¬ç¼–ç çš„è·¯å¾„
   const string kBootUIPath = "UI/Canvas_Boot";
   ```
   **å»ºè®®**: è€ƒè™‘ä½¿ç”¨é…ç½®æ–‡ä»¶æˆ–å¸¸é‡ç±»ç»Ÿä¸€ç®¡ç†è·¯å¾„ã€‚

---

### 3. EventBus.cs â­â­â­â­

**âœ… åšå¾—å¥½çš„åœ°æ–¹**:
- ç®€æ´çš„äº‹ä»¶æ€»çº¿å®ç°
- ä½¿ç”¨å¿«ç…§æœºåˆ¶é¿å…è¿­ä»£æ—¶ä¿®æ”¹é›†åˆçš„é—®é¢˜
- æ³›å‹çº¦æŸç¡®ä¿ç±»å‹å®‰å…¨

**âš ï¸ éœ€è¦æ³¨æ„çš„é—®é¢˜**:

1. **çº¿ç¨‹å®‰å…¨é—®é¢˜** (ğŸ¯ é«˜ä¼˜å…ˆçº§)
   ```csharp
   // ç¬¬15è¡Œï¼šåˆ›å»ºå¿«ç…§æ—¶å¯èƒ½å‘ç”Ÿå¹¶å‘ä¿®æ”¹
   var snapshot = new HashSet<IEventBinding<T>>(bindings);
   ```
   **é—®é¢˜**: åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼ŒHashSet ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚
   
   **å»ºè®®**:
   ```csharp
   public static void Raise(T @event)
   {
       lock (bindings)
       {
           var snapshot = new HashSet<IEventBinding<T>>(bindings);
           
           foreach (var binding in snapshot)
           {
               if (bindings.Contains(binding))
               {
                   binding.OnEvent.Invoke(@event);
                   binding.OnEventNoArgs.Invoke();
               }
           }
       }
   }
   ```

2. **å†…å­˜åˆ†é…** (ğŸ¯ ä¸­ä¼˜å…ˆçº§)
   ```csharp
   // æ¯æ¬¡ Raise éƒ½åˆ›å»ºæ–°çš„ HashSet
   var snapshot = new HashSet<IEventBinding<T>>(bindings);
   ```
   **é—®é¢˜**: é¢‘ç¹çš„äº‹ä»¶è§¦å‘ä¼šå¯¼è‡´å¤§é‡ GC åˆ†é…ã€‚
   
   **å»ºè®®**: ä½¿ç”¨å¯¹è±¡æ± æˆ–è€ƒè™‘ä½¿ç”¨ `List` å¹¶ç”¨ `lock` ä¿æŠ¤ï¼š
   ```csharp
   static readonly List<IEventBinding<T>> _snapshotList = new List<IEventBinding<T>>();
   
   public static void Raise(T @event)
   {
       lock (bindings)
       {
           _snapshotList.Clear();
           _snapshotList.AddRange(bindings);
       }
       
       foreach (var binding in _snapshotList)
       {
           // ... åŸæœ‰é€»è¾‘
       }
   }
   ```

3. **Clear æ–¹æ³•æœªä½¿ç”¨** (ğŸ¯ ä½ä¼˜å…ˆçº§)
   ```csharp
   // ç¬¬27-31è¡Œï¼šClear æ–¹æ³•æ˜¯ static ä½†ä»æœªè¢«è°ƒç”¨
   static void Clear() { ... }
   ```
   **å»ºè®®**: å¦‚æœéœ€è¦æ¸…ç†åŠŸèƒ½ï¼Œåº”è¯¥è®¾ä¸º publicï¼›å¦åˆ™åˆ é™¤ã€‚

---

### 4. YooService.cs â­â­â­â­â­

**âœ… åšå¾—å¥½çš„åœ°æ–¹**:
- å®Œå–„çš„èµ„æºç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒå¼•ç”¨è®¡æ•°
- çº¿ç¨‹å®‰å…¨çš„å®ç°ï¼ˆä½¿ç”¨ lockï¼‰
- è¯¦ç»†çš„æ—¥å¿—è®°å½•ï¼Œä¾¿äºè°ƒè¯•
- æ”¯æŒé¢„åŠ è½½ã€æ‰¹é‡ä¸‹è½½ç­‰é«˜çº§åŠŸèƒ½
- å¼‚æ­¥åˆå§‹åŒ–ä½¿ç”¨ UniTaskCompletionSource é¿å…é‡å¤åˆå§‹åŒ–

**âš ï¸ éœ€è¦æ³¨æ„çš„é—®é¢˜**:

1. **æ­»é”é£é™©** (ğŸ¯ é«˜ä¼˜å…ˆçº§)
   ```csharp
   // ç¬¬426-445è¡Œï¼šåœ¨é”å†…åˆ›å»º Handle
   lock (_handlesGate)
   {
       // ...
       var handle = currentPackage.LoadAssetAsync<T>(address);
       handleInfo = new AssetHandleInfo(handle);
       activeHandles[key] = handleInfo;
       // ...
   }
   ```
   **é—®é¢˜**: åœ¨ lock å†…è°ƒç”¨å¤–éƒ¨æ–¹æ³•å¯èƒ½å¯¼è‡´æ­»é”ã€‚
   
   **å»ºè®®**:
   ```csharp
   AssetHandle handle = null;
   lock (_handlesGate)
   {
       if (activeHandles.TryGetValue(key, out var existingHandleInfo))
       {
           // ... å¢åŠ å¼•ç”¨è®¡æ•°
       }
       else
       {
           isNewHandle = true;
       }
   }
   
   if (isNewHandle)
   {
       // åœ¨é”å¤–åˆ›å»º Handle
       handle = currentPackage.LoadAssetAsync<T>(address);
       lock (_handlesGate)
       {
           handleInfo = new AssetHandleInfo(handle);
           activeHandles[key] = handleInfo;
       }
   }
   ```

2. **å¼‚å¸¸å¤„ç†ä¸­çš„ç«æ€æ¡ä»¶** (ğŸ¯ ä¸­ä¼˜å…ˆçº§)
   ```csharp
   // ç¬¬467è¡Œï¼šæ£€æŸ¥å’Œæ“ä½œä¸æ˜¯åŸå­çš„
   if (activeHandles.TryGetValue(key, out var info) && info == handleInfo)
   ```
   **é—®é¢˜**: è™½ç„¶åœ¨ lock å†…ï¼Œä½†é€»è¾‘å¤æ‚ï¼Œå®¹æ˜“å‡ºé”™ã€‚
   
   **å»ºè®®**: ç®€åŒ–é€»è¾‘ï¼Œç¡®ä¿åŸå­æ€§ã€‚

3. **ç½‘ç»œè¯·æ±‚è¶…æ—¶å¤„ç†** (ğŸ¯ ä¸­ä¼˜å…ˆçº§)
   ```csharp
   // ç¬¬591è¡Œï¼šè¶…æ—¶æ—¶é—´å›ºå®šä¸º 5 ç§’
   request.timeout = 5;
   ```
   **å»ºè®®**: å°†è¶…æ—¶æ—¶é—´ä½œä¸ºé…ç½®é¡¹ï¼Œä¸åŒç½‘ç»œç¯å¢ƒå¯èƒ½éœ€è¦ä¸åŒçš„è¶…æ—¶è®¾ç½®ã€‚

---

### 5. PersistentSingleton.cs â­â­â­â­

**âœ… åšå¾—å¥½çš„åœ°æ–¹**:
- æ³›å‹å•ä¾‹å®ç°ä¼˜é›…
- DontDestroyOnLoad ç¡®ä¿è·¨åœºæ™¯æŒä¹…åŒ–
- è‡ªåŠ¨åˆ›å»ºæœºåˆ¶æ–¹ä¾¿ä½¿ç”¨

**âš ï¸ éœ€è¦æ³¨æ„çš„é—®é¢˜**:

1. **FindAnyObjectByType æ€§èƒ½é—®é¢˜** (ğŸ¯ ä¸­ä¼˜å…ˆçº§)
   ```csharp
   // ç¬¬22è¡Œï¼šæ¯æ¬¡è®¿é—® Instance éƒ½å¯èƒ½è°ƒç”¨
   instance = FindAnyObjectByType<T>();
   ```
   **é—®é¢˜**: FindAnyObjectByType æ˜¯æ˜‚è´µçš„æ“ä½œï¼Œåœ¨å¤§å‹åœºæ™¯ä¸­æ€§èƒ½å¼€é”€å¤§ã€‚
   
   **å»ºè®®**: æ·»åŠ ç¼“å­˜æ ‡è®°ï¼š
   ```csharp
   private static bool _searched = false;
   
   public static T Instance
   {
       get
       {
           if (instance == null && !_searched)
           {
               _searched = true;
               instance = FindAnyObjectByType<T>();
               // ...
           }
           return instance;
       }
   }
   ```

2. **åŒé‡å®ä¾‹é—®é¢˜** (ğŸ¯ ä½ä¼˜å…ˆçº§)
   ```csharp
   // ç¬¬59-62è¡Œï¼šå¦‚æœå·²å­˜åœ¨å®ä¾‹ï¼Œé”€æ¯å½“å‰å¯¹è±¡
   if (instance != this)
   {
       Destroy(gameObject);
   }
   ```
   **å»ºè®®**: åœ¨é”€æ¯å‰è®°å½•è­¦å‘Šæ—¥å¿—ï¼š
   ```csharp
   Debug.LogWarning($"Duplicate {typeof(T).Name} instance found and destroyed.");
   ```

---

## ğŸ› æ½œåœ¨ Bug æ±‡æ€»

### é«˜ä¼˜å…ˆçº§é—®é¢˜

1. **GameManager.cs**: å¼‚å¸¸å¤„ç†ä¸å®Œæ•´ï¼Œæœªåˆ‡æ¢åˆ°é”™è¯¯æµç¨‹
2. **Bootstrap.cs**: BootUI èµ„æºæ³„æ¼
3. **EventBus.cs**: çº¿ç¨‹å®‰å…¨é—®é¢˜
4. **YooService.cs**: æ­»é”é£é™©

### ä¸­ä¼˜å…ˆçº§é—®é¢˜

1. **GameManager.cs**: ç©ºå¼•ç”¨é£é™©
2. **Bootstrap.cs**: GameManager è‡ªåŠ¨åˆ›å»ºå¯èƒ½ä¸ç¬¦åˆé¢„æœŸ
3. **EventBus.cs**: é¢‘ç¹ GC åˆ†é…
4. **YooService.cs**: å¼‚å¸¸å¤„ç†ä¸­çš„ç«æ€æ¡ä»¶

---

## âš¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. EventBus ä¼˜åŒ–
- ä½¿ç”¨å¯¹è±¡æ± å‡å°‘ GC åˆ†é…
- è€ƒè™‘ä½¿ç”¨ `List` ä»£æ›¿ `HashSet`ï¼ˆå¦‚æœä¸éœ€è¦å¿«é€ŸæŸ¥æ‰¾ï¼‰

### 2. èµ„æºåŠ è½½ä¼˜åŒ–
- YooService ä¸­çš„å¼•ç”¨è®¡æ•°æœºåˆ¶å·²ç»å¾ˆå¥½ï¼Œç»§ç»­ä¿æŒ
- è€ƒè™‘æ·»åŠ èµ„æºé¢„çƒ­æœºåˆ¶

### 3. å­—ç¬¦ä¸²æ“ä½œä¼˜åŒ–
```csharp
// Perf.cs ä¸­å¤šæ¬¡ä½¿ç”¨å­—ç¬¦ä¸²æ’å€¼
Debug.Log($"[Unity] Mono Heap Size: {monoHeapSize / 1048576f:F1} MB");
```
**å»ºè®®**: ä½¿ç”¨ StringBuilder æˆ–è€ƒè™‘ä½¿ç”¨æ¡ä»¶ç¼–è¯‘å»é™¤ Release ç‰ˆæœ¬çš„æ—¥å¿—ã€‚

### 4. Update/FixedUpdate æ£€æŸ¥
- æœªå‘ç°æ˜æ˜¾çš„ Update/FixedUpdate æ€§èƒ½é—®é¢˜
- JustTest.cs ä¸­çš„ Update æ˜¯ç©ºçš„ï¼Œå¯ä»¥åˆ é™¤

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡è¯„ä¼°

### ä¼˜ç‚¹

1. **æ¸…æ™°çš„åˆ†å±‚æ¶æ„**: 
   - SubSystem æ¨¡å¼è®¾è®¡åˆç†
   - æœåŠ¡æ³¨å†Œæœºåˆ¶ï¼ˆGameServicesï¼‰è§£è€¦è‰¯å¥½

2. **ä¾èµ–æ³¨å…¥**: 
   - Flow å’Œ Service ä½¿ç”¨æ„é€ å‡½æ•°æ³¨å…¥
   - æé«˜å¯æµ‹è¯•æ€§å’Œå¯ç»´æŠ¤æ€§

3. **äº‹ä»¶é©±åŠ¨**: 
   - EventBus å®ç°ç®€æ´
   - å‡å°‘æ¨¡å—é—´è€¦åˆ

### æ”¹è¿›å»ºè®®

1. **æ¥å£éš”ç¦»**: 
   - æŸäº›æ¥å£ï¼ˆå¦‚ IControlServiceï¼‰æ˜¯ç©ºçš„ï¼Œåº”è¯¥æ·»åŠ æ–¹æ³•æˆ–åˆ é™¤
   
2. **èŒè´£åˆ†ç¦»**: 
   - Bootstrap.cs èŒè´£è¾ƒé‡ï¼Œå»ºè®®æ‹†åˆ†ä¸ºå¤šä¸ªç±»

3. **é”™è¯¯å¤„ç†ç»Ÿä¸€**: 
   - å»ºè®®æ·»åŠ å…¨å±€é”™è¯¯å¤„ç†å™¨
   - ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç­–ç•¥

---

## ğŸ”’ å®‰å…¨æ€§å®¡æŸ¥

### 1. è¾“å…¥éªŒè¯

**âœ… åšå¾—å¥½**:
- YooService ä¸­å¯¹ null å‚æ•°è¿›è¡Œäº†æ£€æŸ¥
- Bootstrap ä¸­éªŒè¯äº†é…ç½®å¯¹è±¡

**âš ï¸ éœ€è¦æ”¹è¿›**:
```csharp
// GameManager.cs ç¬¬38è¡Œ
RunFlow(FlowID.TestScene); // ç¡¬ç¼–ç çš„åˆå§‹æµç¨‹
```
**å»ºè®®**: ä»é…ç½®æ–‡ä»¶è¯»å–åˆå§‹æµç¨‹ IDã€‚

### 2. èµ„æºè®¿é—®æ§åˆ¶

**âœ… åšå¾—å¥½**:
- YooService ä½¿ç”¨ lock ä¿æŠ¤å…±äº«èµ„æº
- å¼•ç”¨è®¡æ•°æœºåˆ¶é˜²æ­¢è¿‡æ—©é‡Šæ”¾

**âš ï¸ éœ€è¦æ”¹è¿›**:
- æ·»åŠ èµ„æºè®¿é—®æƒé™æ£€æŸ¥
- é˜²æ­¢æ¶æ„æˆ–é”™è¯¯çš„èµ„æºè·¯å¾„

---

## ğŸ“ å¯ç»´æŠ¤æ€§è¯„ä¼°

### ä»£ç å¯è¯»æ€§ â­â­â­â­

**ä¼˜ç‚¹**:
- å‘½åè§„èŒƒç»Ÿä¸€ï¼ˆ_å¼€å¤´è¡¨ç¤ºç§æœ‰å­—æ®µï¼‰
- éƒ¨åˆ†å…³é”®ä»£ç æœ‰æ³¨é‡Š
- ä»£ç ç»“æ„æ¸…æ™°

**æ”¹è¿›å»ºè®®**:
1. å¢åŠ  XML æ–‡æ¡£æ³¨é‡Šï¼š
   ```csharp
   /// <summary>
   /// æ¸¸æˆç®¡ç†å™¨ï¼Œè´Ÿè´£ç®¡ç†æ¸¸æˆæµç¨‹å’Œå­ç³»ç»Ÿ
   /// </summary>
   public class GameManager : PersistentSingleton<GameManager>
   ```

2. å¤æ‚é€»è¾‘æ·»åŠ æ³¨é‡Šï¼š
   ```csharp
   // YooService.cs ç¬¬426-494è¡Œçš„åŠ è½½é€»è¾‘è¾ƒå¤æ‚
   // å»ºè®®æ·»åŠ è¯¦ç»†çš„æ³¨é‡Šè¯´æ˜å¼•ç”¨è®¡æ•°æœºåˆ¶
   ```

### å¯æ‰©å±•æ€§ â­â­â­â­â­

**ä¼˜ç‚¹**:
- SubSystem æœºåˆ¶æ˜“äºæ‰©å±•
- Flow å·¥å‚æ¨¡å¼æ”¯æŒæ·»åŠ æ–°æµç¨‹
- æœåŠ¡æ³¨å†Œæœºåˆ¶çµæ´»

**å»ºè®®**:
- è€ƒè™‘ä½¿ç”¨ä¾èµ–æ³¨å…¥å®¹å™¨ï¼ˆå¦‚ VContainerï¼‰
- æ·»åŠ æ’ä»¶æœºåˆ¶æ”¯æŒè¿è¡Œæ—¶æ‰©å±•

---

## ğŸ¯ ä¼˜å…ˆä¿®å¤å»ºè®®

### ç«‹å³ä¿®å¤ï¼ˆæœ¬å‘¨å†…ï¼‰

1. âœ… **Bootstrap.cs**: ä¿®å¤ BootUI èµ„æºæ³„æ¼
2. âœ… **EventBus.cs**: æ·»åŠ çº¿ç¨‹å®‰å…¨ä¿æŠ¤
3. âœ… **GameManager.cs**: å®Œå–„é”™è¯¯å¤„ç†æµç¨‹

### çŸ­æœŸä¿®å¤ï¼ˆæœ¬æœˆå†…ï¼‰

1. âš ï¸ **YooService.cs**: ä¼˜åŒ–é”çš„ä½¿ç”¨èŒƒå›´
2. âš ï¸ **PersistentSingleton.cs**: ä¼˜åŒ– FindAnyObjectByType è°ƒç”¨
3. âš ï¸ **åˆ é™¤ç©ºå®ç°ç±»**: GlobalParticleBudgetSystem, IControlService

### é•¿æœŸä¼˜åŒ–

1. ğŸ’¡ æ·»åŠ å®Œæ•´çš„å•å…ƒæµ‹è¯•
2. ğŸ’¡ å¼•å…¥ä¾èµ–æ³¨å…¥å®¹å™¨
3. ğŸ’¡ ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿï¼ˆç§»é™¤ Debug.Logï¼‰
4. ğŸ’¡ æ·»åŠ æ€§èƒ½ç›‘æ§ç³»ç»Ÿ

---

## ğŸ“ˆ ä»£ç è´¨é‡è¯„åˆ†

| ç»´åº¦ | è¯„åˆ† | è¯´æ˜ |
|------|------|------|
| ä»£ç è´¨é‡ | â­â­â­â­ | æ•´ä½“è´¨é‡è‰¯å¥½ï¼Œéµå¾ª C# æœ€ä½³å®è·µ |
| æ½œåœ¨ Bug | â­â­â­ | å­˜åœ¨ä¸€äº›éœ€è¦ä¿®å¤çš„é—®é¢˜ï¼Œä½†ä¸å½±å“åŸºæœ¬åŠŸèƒ½ |
| æ€§èƒ½ | â­â­â­â­ | æ€§èƒ½è€ƒè™‘å‘¨åˆ°ï¼Œä½¿ç”¨äº†å¼‚æ­¥å’Œå¼•ç”¨è®¡æ•° |
| æ¶æ„è®¾è®¡ | â­â­â­â­â­ | æ¶æ„æ¸…æ™°ï¼Œè§£è€¦è‰¯å¥½ï¼Œæ‰©å±•æ€§å¼º |
| å®‰å…¨æ€§ | â­â­â­â­ | åŸºæœ¬çš„å®‰å…¨æªæ–½åˆ°ä½ï¼Œéœ€è¦åŠ å¼ºè¾“å…¥éªŒè¯ |
| å¯ç»´æŠ¤æ€§ | â­â­â­â­ | ä»£ç ç»“æ„æ¸…æ™°ï¼Œä½†æ³¨é‡Šéœ€è¦åŠ å¼º |

**æ€»ä½“è¯„åˆ†**: â­â­â­â­ (4/5)

---

## ğŸ’¡ æ€»ç»“ä¸å»ºè®®

### æ•´ä½“è¯„ä»·

Assets/Runtime ç›®å½•ä¸‹çš„ä»£ç æ•´ä½“è´¨é‡**å¾ˆå¥½**ï¼Œå±•ç°äº†è‰¯å¥½çš„æ¶æ„è®¾è®¡å’Œç¼–ç å®è·µã€‚ä¸»è¦äº®ç‚¹åŒ…æ‹¬ï¼š

1. æ¸…æ™°çš„æ¨¡å—åŒ–è®¾è®¡ï¼ˆSubSystem æ¨¡å¼ï¼‰
2. å®Œå–„çš„èµ„æºç®¡ç†ç³»ç»Ÿï¼ˆYooServiceï¼‰
3. ä¼˜é›…çš„äº‹ä»¶é©±åŠ¨æ¶æ„ï¼ˆEventBusï¼‰
4. è‰¯å¥½çš„å¼‚æ­¥ç¼–ç¨‹å®è·µï¼ˆUniTaskï¼‰

### ä¸»è¦æ”¹è¿›æ–¹å‘

1. **åŠ å¼ºçº¿ç¨‹å®‰å…¨**: ç‰¹åˆ«æ˜¯ EventBus å’Œå…±äº«èµ„æºè®¿é—®
2. **å®Œå–„èµ„æºæ¸…ç†**: ç¡®ä¿æ‰€æœ‰åˆ›å»ºçš„å¯¹è±¡éƒ½è¢«æ­£ç¡®é‡Šæ”¾
3. **å¢å¼ºé”™è¯¯å¤„ç†**: ç»Ÿä¸€é”™è¯¯å¤„ç†ç­–ç•¥ï¼Œé¿å…é™é»˜å¤±è´¥
4. **ä¼˜åŒ–æ€§èƒ½**: å‡å°‘ GC åˆ†é…ï¼Œä¼˜åŒ–é¢‘ç¹è°ƒç”¨çš„æ–¹æ³•
5. **å¢åŠ æ–‡æ¡£**: ä¸ºå…¬å…± API æ·»åŠ  XML æ³¨é‡Š

### ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. åˆ›å»º GitHub Issues è·Ÿè¸ªé«˜ä¼˜å…ˆçº§é—®é¢˜
2. ä¸ºæ ¸å¿ƒæ¨¡å—æ·»åŠ å•å…ƒæµ‹è¯•
3. å»ºç«‹ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•
4. å®šæœŸè¿›è¡Œæ€§èƒ½åˆ†æ

---

**å®¡æŸ¥å®Œæˆæ—¶é—´**: 2025-12-24  
**ä¸‹æ¬¡å®¡æŸ¥å»ºè®®**: ä¿®å¤é«˜ä¼˜å…ˆçº§é—®é¢˜åè¿›è¡Œå¤å®¡
